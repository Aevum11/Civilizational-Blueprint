@echo off & cd /d "%~dp0" & title ET ARCHIVE EXTRACTOR & echo [STATUS] Analyzing File Structure... & python -x "%~f0" %* & pause & goto :eof
import os
import sys
import zipfile
import shutil

# --- ET ARCHIVE EXTRACTOR ---
# TARGET: ET Math Compendium.pdf (Confirmed ZIP Archive)
# GOAL: Extract 25 text files and 25 images directly.

sys.stdout.reconfigure(encoding='utf-8')

def main():
    target_file = "ET Math Compendium.pdf"
    output_dir = "compendium_extracted"
    
    # 1. VALIDATION
    if not os.path.exists(target_file):
        print(f"[!] ERROR: Target file '{target_file}' not found.")
        print(f"    Current Directory: {os.getcwd()}")
        sys.exit(1)

    # 2. PREPARE OUTPUT DIRECTORY
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
        print(f"[*] Created output directory: {output_dir}")

    print(f"[*] Target detected: {target_file}")
    
    # 3. EXECUTE ZIP EXTRACTION
    # We bypass PDF logic entirely and treat it as a ZIP, matching the 'unzip' command.
    try:
        print("[*] Attempting Direct ZIP Extraction...")
        
        # Check if it's a valid zip regardless of extension
        if not zipfile.is_zipfile(target_file):
            print("[!] Warning: Python 'is_zipfile' check failed. Attempting forced read...")

        with zipfile.ZipFile(target_file, 'r') as z:
            # List contents
            file_list = z.namelist()
            file_count = len(file_list)
            print(f"[*] ZIP HEADER CONFIRMED. Contains {file_count} files.")
            
            # Extract
            z.extractall(output_dir)
            
            # Verify specific file counts (User mentioned 25 text/25 images)
            txt_files = [f for f in file_list if f.lower().endswith('.txt')]
            img_files = [f for f in file_list if f.lower().endswith(('.jpg', '.jpeg', '.png'))]
            
            print(f"[+] SUCCESS: Extracted {file_count} items.")
            print(f"    - Text Files: {len(txt_files)}")
            print(f"    - Image Files: {len(img_files)}")
            
            if len(txt_files) > 0:
                print(f"[*] Sample: {txt_files[0]}")

    except zipfile.BadZipFile:
        print("[!] ERROR: The file header does not match a ZIP archive.")
        print("    Possibilities:")
        print("    1. The file was re-saved as a genuine PDF by a viewer.")
        print("    2. The file is corrupted.")
    except Exception as e:
        print(f"[!] CRITICAL FAILURE: {e}")

    print(f"\n[*] Extraction Location: {os.path.abspath(output_dir)}")

if __name__ == "__main__":
    main()